(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[164],{285:(e,s,r)=>{"use strict";r.d(s,{$:()=>c,r:()=>d});var t=r(5155),a=r(2115),l=r(4253),n=r(2085),i=r(9434);let d=(0,n.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),c=a.forwardRef((e,s)=>{let{className:r,variant:a,size:n,asChild:c=!1,...o}=e,u=c?l.DX:"button";return(0,t.jsx)(u,{className:(0,i.cn)(d({variant:a,size:n,className:r})),ref:s,...o})});c.displayName="Button"},1394:(e,s,r)=>{"use strict";r.d(s,{BK:()=>d,eu:()=>i,q5:()=>c});var t=r(5155),a=r(2115),l=r(5977),n=r(9434);let i=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)(l.bL,{ref:s,className:(0,n.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...a})});i.displayName=l.bL.displayName;let d=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)(l._V,{ref:s,className:(0,n.cn)("aspect-square h-full w-full",r),...a})});d.displayName=l._V.displayName;let c=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)(l.H4,{ref:s,className:(0,n.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...a})});c.displayName=l.H4.displayName},2523:(e,s,r)=>{"use strict";r.d(s,{p:()=>n});var t=r(5155),a=r(2115),l=r(9434);let n=a.forwardRef((e,s)=>{let{className:r,type:a,...n}=e;return(0,t.jsx)("input",{type:a,className:(0,l.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:s,...n})});n.displayName="Input"},4607:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>C});var t=r(5155),a=r(2115),l=r(1394),n=r(285),i=r(6695),d=r(2523),c=r(7655),o=r(9434);let u=a.forwardRef((e,s)=>{let{className:r,children:a,...l}=e;return(0,t.jsxs)(c.bL,{ref:s,className:(0,o.cn)("relative overflow-hidden",r),...l,children:[(0,t.jsx)(c.LM,{className:"h-full w-full rounded-[inherit]",children:a}),(0,t.jsx)(m,{}),(0,t.jsx)(c.OK,{})]})});u.displayName=c.bL.displayName;let m=a.forwardRef((e,s)=>{let{className:r,orientation:a="vertical",...l}=e;return(0,t.jsx)(c.VM,{ref:s,orientation:a,className:(0,o.cn)("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...l,children:(0,t.jsx)(c.lr,{className:"relative flex-1 rounded-full bg-border"})})});m.displayName=c.VM.displayName;var f=r(286),x=r(5074),p=r(2543),h=r(7687),g=r(8539),v=r(5317),b=r(6104),j=r(6874),N=r.n(j);function y(){return(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground p-4 text-center bg-gray-50 dark:bg-gray-900/50 rounded-lg",children:[(0,t.jsx)("div",{className:"mb-4 rounded-full bg-primary/10 p-4",children:(0,t.jsx)(f.A,{className:"h-10 w-10 text-primary"})}),(0,t.jsx)("h3",{className:"text-xl font-semibold text-foreground mb-1",children:"Find your neighbors"}),(0,t.jsx)("p",{className:"mb-4 max-w-sm",children:"It looks like you haven't started any conversations yet. Once you do, they'll appear here."}),(0,t.jsx)(n.$,{asChild:!0,children:(0,t.jsx)(N(),{href:"/neighbors",children:"Find Neighbors"})})]})}function w(e){let{conversations:s,currentUser:r}=e,[c,m]=(0,a.useState)(s),[f,j]=(0,a.useState)(null),[N,w]=(0,a.useState)([]),[k,I]=(0,a.useState)(""),E=(0,a.useRef)(null);(0,a.useEffect)(()=>{m(s)},[s]),(0,a.useEffect)(()=>{if(!f)return;let e=(0,v.P)((0,v.rJ)(b.db,"conversations",f.id,"messages"),(0,v.My)("timestamp","asc")),s=(0,v.aQ)(e,async e=>{let s=[];for(let a of e.docs){var t;let e=a.data(),l=e.senderId===r.id?r:f.participant;if(e.senderId!==r.id&&e.senderId!==f.participant.id){let s=await (0,v.x7)((0,v.H9)(b.db,"users",e.senderId));s.exists()&&(l={id:s.id,...s.data()})}s.push({id:a.id,senderId:e.senderId,text:e.text,sender:l,timestamp:(null==(t=e.timestamp)?void 0:t.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"...",read:e.read})}w(s)});return()=>s()},[f,r]),(0,a.useEffect)(()=>{E.current&&E.current.scrollTo({top:E.current.scrollHeight,behavior:"smooth"})},[N]);let C=async e=>{if(e.preventDefault(),""===k.trim()||!f)return;let s=(0,v.H9)(b.db,"conversations",f.id),t=(0,v.rJ)(s,"messages");try{await (0,v.c4)(b.db,async e=>{await (0,v.gS)(t,{senderId:r.id,text:k,timestamp:(0,v.O5)(),read:!1}),e.update(s,{lastMessage:{text:k,senderId:r.id,timestamp:(0,v.O5)(),read:!1}})}),I("")}catch(e){console.error("Error sending message: ",e)}},R=e=>{j(e)};return(0,t.jsxs)(i.Zp,{className:"h-[calc(100vh-10rem)] w-full flex overflow-hidden",children:[(0,t.jsxs)("div",{className:(0,o.cn)("w-full md:w-1/3 border-r transition-transform duration-300 ease-in-out flex flex-col","md:translate-x-0",f?"-translate-x-full":"translate-x-0"),children:[(0,t.jsxs)("div",{className:"p-4 border-b",children:[(0,t.jsx)("h2",{className:"text-xl font-bold mb-4",children:"Messages"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(x.A,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(d.p,{placeholder:"Search messages",className:"pl-8"})]})]}),(0,t.jsx)(u,{className:"flex-1",children:c.length>0?c.map(e=>{var s;return(0,t.jsxs)("div",{className:(0,o.cn)("flex items-center gap-4 p-4 cursor-pointer hover:bg-muted/50",(null==f?void 0:f.id)===e.id&&"bg-muted/50"),onClick:()=>R(e),children:[(0,t.jsxs)(l.eu,{children:[(0,t.jsx)(l.BK,{src:e.participant.avatarUrl,alt:e.participant.name,"data-ai-hint":"person portrait"}),(0,t.jsx)(l.q5,{children:e.participant.name.charAt(0)})]}),(0,t.jsxs)("div",{className:"flex-1 truncate",children:[(0,t.jsx)("p",{className:"font-semibold",children:e.participant.name}),(0,t.jsx)("p",{className:"text-sm text-muted-foreground truncate",children:null==(s=e.messages[e.messages.length-1])?void 0:s.text})]})]},e.id)}):(0,t.jsx)("div",{className:"p-4",children:(0,t.jsx)(y,{})})})]}),(0,t.jsx)("div",{className:(0,o.cn)("w-full md:w-2/3 flex flex-col absolute md:static inset-0 transition-transform duration-300 ease-in-out bg-background","md:translate-x-0",f?"translate-x-0":"translate-x-full"),children:f?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"flex items-center gap-4 p-3 border-b",children:[(0,t.jsx)(n.$,{variant:"ghost",size:"icon",className:"md:hidden",onClick:()=>j(null),children:(0,t.jsx)(p.A,{className:"h-5 w-5"})}),(0,t.jsxs)(l.eu,{children:[(0,t.jsx)(l.BK,{src:f.participant.avatarUrl,alt:f.participant.name,"data-ai-hint":"person portrait"}),(0,t.jsx)(l.q5,{children:f.participant.name.charAt(0)})]}),(0,t.jsx)("p",{className:"font-semibold",children:f.participant.name})]}),(0,t.jsx)(u,{className:"flex-1 p-4 bg-gray-50 dark:bg-gray-900",ref:E,children:(0,t.jsx)("div",{className:"space-y-4",children:N.map(e=>(0,t.jsxs)("div",{className:(0,o.cn)("flex gap-3",e.sender.id===r.id?"justify-end":"justify-start"),children:[e.sender.id!==r.id&&(0,t.jsxs)(l.eu,{className:"h-8 w-8",children:[(0,t.jsx)(l.BK,{src:e.sender.avatarUrl,"data-ai-hint":"person portrait"}),(0,t.jsx)(l.q5,{children:e.sender.name.charAt(0)})]}),(0,t.jsxs)("div",{className:(0,o.cn)("rounded-lg px-4 py-2 max-w-xs lg:max-w-md break-words",e.sender.id===r.id?"bg-primary text-primary-foreground":"bg-card border"),children:[(0,t.jsx)("p",{children:e.text}),(0,t.jsx)("p",{className:(0,o.cn)("text-xs opacity-70 mt-1",e.sender.id===r.id?"text-right":"text-left"),children:e.timestamp})]})]},e.id))})}),(0,t.jsx)("div",{className:"p-4 border-t bg-card",children:(0,t.jsxs)("form",{onSubmit:C,className:"flex items-center gap-2",children:[(0,t.jsx)(g.T,{placeholder:"Type a message...",value:k,onChange:e=>I(e.target.value),className:"flex-1 resize-none",rows:1,onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),C(e))}}),(0,t.jsx)(n.$,{type:"submit",size:"icon",disabled:!k.trim(),children:(0,t.jsx)(h.A,{className:"h-5 w-5"})})]})})]}):(0,t.jsx)("div",{className:"hidden md:flex flex-1 items-center justify-center text-muted-foreground p-8",children:(0,t.jsx)(y,{})})})]})}var k=r(8030),I=r(8856);let E=()=>(0,t.jsxs)("div",{className:"p-4 space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(I.E,{className:"h-12 w-12 rounded-full"}),(0,t.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,t.jsx)(I.E,{className:"h-4 w-3/4"}),(0,t.jsx)(I.E,{className:"h-4 w-1/2"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(I.E,{className:"h-12 w-12 rounded-full"}),(0,t.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,t.jsx)(I.E,{className:"h-4 w-3/4"}),(0,t.jsx)(I.E,{className:"h-4 w-1/2"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[(0,t.jsx)(I.E,{className:"h-12 w-12 rounded-full"}),(0,t.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,t.jsx)(I.E,{className:"h-4 w-3/4"}),(0,t.jsx)(I.E,{className:"h-4 w-1/2"})]})]})]});function C(){let{user:e}=(0,k.A)(),[s,r]=(0,a.useState)([]),[l,n]=(0,a.useState)(!0),i=e?{id:e.uid,uid:e.uid,name:e.displayName||"Anonymous",avatarUrl:e.photoURL||"https://placehold.co/100x100.png"}:null;return((0,a.useEffect)(()=>{if(!e)return void n(!1);let s=(0,v.P)((0,v.rJ)(b.db,"conversations"),(0,v._M)("participantIds","array-contains",e.uid)),t=(0,v.aQ)(s,async s=>{let t=s.docs.map(async s=>{var r;let t=s.data(),a=t.participantIds.find(s=>s!==e.uid);if(!a)return null;let l=await (0,v.x7)((0,v.H9)(b.db,"users",a));if(!l.exists())return null;let n={id:l.id,...l.data()},d=t.lastMessage;return{id:s.id,participant:n,messages:d?[{id:"last",senderId:d.senderId,sender:d.senderId===(null==i?void 0:i.id)?i:n,text:d.text,timestamp:(null==(r=d.timestamp)?void 0:r.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))||"...",read:d.read}]:[]}});r((await Promise.all(t)).filter(Boolean)),n(!1)});return()=>t()},[e,i]),l)?(0,t.jsx)(E,{}):i?(0,t.jsx)(w,{conversations:s,currentUser:i}):(0,t.jsx)(y,{})}},4711:(e,s,r)=>{Promise.resolve().then(r.bind(r,4607))},6104:(e,s,r)=>{"use strict";r.d(s,{IG:()=>o,db:()=>c,hJ:()=>u,j2:()=>d,sm:()=>m});var t=r(3915),a=r(3004),l=r(5317),n=r(858);let i=(0,t.Dk)().length?(0,t.Sx)():(0,t.Wp)({projectId:"yrdly-coyig",appId:"1:166095077947:web:2f5285213610bbd893521e",storageBucket:"yrdly-coyig.firebasestorage.app",apiKey:"AIzaSyCOE_L6g9c3J6jhcajVzNkC4flEao4Av2I",authDomain:"yrdly-coyig.firebaseapp.com",measurementId:"",messagingSenderId:"166095077947"}),d=(0,a.xI)(i),c=(0,l.aU)(i),o=(0,n.c7)(i),u=new a.HF,m=new a.LD("apple.com")},6695:(e,s,r)=>{"use strict";r.d(s,{BT:()=>c,Wu:()=>o,ZB:()=>d,Zp:()=>n,aR:()=>i,wL:()=>u});var t=r(5155),a=r(2115),l=r(9434);let n=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",r),...a})});n.displayName="Card";let i=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",r),...a})});i.displayName="CardHeader";let d=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("text-2xl font-semibold leading-none tracking-tight",r),...a})});d.displayName="CardTitle";let c=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("text-sm text-muted-foreground",r),...a})});c.displayName="CardDescription";let o=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("p-6 pt-0",r),...a})});o.displayName="CardContent";let u=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,l.cn)("flex items-center p-6 pt-0",r),...a})});u.displayName="CardFooter"},8030:(e,s,r)=>{"use strict";r.d(s,{A:()=>c,AuthProvider:()=>d});var t=r(5155),a=r(2115),l=r(3004),n=r(6104);let i=(0,a.createContext)({user:null,loading:!0}),d=e=>{let{children:s}=e,[r,d]=(0,a.useState)(null),[c,o]=(0,a.useState)(!0);return(0,a.useEffect)(()=>{let e=(0,l.hg)(n.j2,e=>{d(e),o(!1)});return()=>e()},[]),(0,t.jsx)(i.Provider,{value:{user:r,loading:c},children:s})},c=()=>(0,a.useContext)(i)},8539:(e,s,r)=>{"use strict";r.d(s,{T:()=>n});var t=r(5155),a=r(2115),l=r(9434);let n=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("textarea",{className:(0,l.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:s,...a})});n.displayName="Textarea"},8856:(e,s,r)=>{"use strict";r.d(s,{E:()=>l});var t=r(5155),a=r(9434);function l(e){let{className:s,...r}=e;return(0,t.jsx)("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",s),...r})}},9434:(e,s,r)=>{"use strict";r.d(s,{cn:()=>l});var t=r(2596),a=r(9688);function l(){for(var e=arguments.length,s=Array(e),r=0;r<e;r++)s[r]=arguments[r];return(0,a.QP)((0,t.$)(s))}}},e=>{var s=s=>e(e.s=s);e.O(0,[992,644,340,172,874,333,441,684,358],()=>s(4711)),_N_E=e.O()}]);